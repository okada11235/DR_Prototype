<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>å…¨ä½“å¹³å‡ã‚¹ã‚³ã‚¢</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <style>
    body{font-family:"Hiragino Sans","Meiryo",sans-serif;background:#cdeae0;margin:0;color:#333;padding-bottom:55px}
    h1{color:#007e99;font-size:1.4em;margin:20px 0;text-align:center}
    .score-section{max-width:480px;margin:0 auto;padding:0 20px}
    .score-item{display:flex;align-items:center;margin:10px 0;font-size:1em}
    .bar{height:10px;background:#d0d9ff;border-radius:5px;margin-left:10px;flex-grow:1;position:relative}
    .bar::after{content:"";position:absolute;top:0;left:0;height:100%;background:#5579ff;border-radius:5px}
    .score{color:red;font-weight:bold;margin-left:10px;min-width:3em;text-align:right}
    .record-box{background:#f8fdf9;border-radius:10px;padding:15px;margin-top:30px;box-shadow:inset 0 0 4px rgba(0,0,0,.1)}
    .record-title{font-weight:bold;margin-bottom:10px}
    .record-list{max-height:500px;overflow-y:auto;font-family:monospace;background:#fff;border-radius:8px;padding:10px;font-size:.95em}
    .list-item{display:block;padding:12px 10px;border-bottom:1px solid #e0ece6;background:#fff}
    .list-item:last-child{border-bottom:none}
    .list-item .item-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:8px;font-weight:bold}
    .list-item .item-date{color:#333;font-size:0.95em}
    .list-item .item-score{color:#ff6b6b;font-size:1.1em;margin-left:10px}
    .list-item .item-info{color:#666;font-size:0.9em;line-height:1.6}
    .list-item .item-actions{display:flex;justify-content:space-between;gap:8px;margin-top:10px;align-items:center}
    .list-item a{font-weight:bold;color:#007e99;text-decoration:none;padding:6px 12px;background:#e6f3f5;border-radius:4px;display:inline-block}
    .list-item a:hover{background:#cfe8ec}
    .custom-nav-bar{background:#378da0;border-top:2px solid #5a7d8d;box-shadow:inset 0 0 5px rgba(0,0,0,.2);height:45px}
    .custom-nav-link{color:#fff;font-weight:bold;font-size:1rem;padding:0 1rem;line-height:41px;height:100%;display:block}
    .custom-nav-item:not(:last-child){border-right:1px solid #5a7d8d}
    .active-glow .custom-nav-link.active{color:rgb(0, 0, 0);text-shadow:0 0 5px #000000,0 0 10px #7a8cff;background:rgba(255,255,255,.05)}
    .date { font-weight: bold; color: #444; }
    .time { color: #007e99; font-size: 0.95em; }
    /* ğŸ”´ é€šå¸¸ã®å‰Šé™¤ãƒœã‚¿ãƒ³ */
    .btn-danger-custom {
      background-color: #e74c3c;
      border: none;
      color: white;
      padding: 6px 14px;
      border-radius: 6px;
      font-size: 0.95rem;
      font-weight: 600;
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
    }

    .btn-danger-custom:hover {
      background-color: #c0392b;
      transform: translateY(-1px);
    }

    /* ğŸŒ€ å‰Šé™¤ä¸­ã®çŠ¶æ…‹ */
    .btn-deleting {
      background-color: #b0b0b0 !important;
      color: #333 !important;
      border-color: #aaa !important;
      cursor: not-allowed;
      box-shadow: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-weight: 600;
    }

    /* Bootstrapã®ã‚¹ãƒ”ãƒŠãƒ¼ã®å¤§ãã•èª¿æ•´ */
    .spinner-border-sm {
      width: 1rem;
      height: 1rem;
      border-width: 0.15em;
    }

    /* å‰Šé™¤ãƒ•ã‚©ãƒ¼ãƒ ã®ä½™ç™½ */
    form {
      margin-top: 10px;
    }
  </style>
</head>
<body>

    <!-- ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ -->
    <div class="record-box mt-4">
      <div class="record-title">è¨˜éŒ²ä¸€è¦§</div>
      <div class="record-list">
        {% if sessions %}
          {% for s in sessions %}
          <div class="list-item" id="session-{{ s.id }}">
            <div class="item-header">
              <span class="item-date">
                {% if s.start_time %}
                  {{ s.start_time.strftime('%Y/%m/%d %H:%M') }}
                  ã€œ
                  {{ s.end_time.strftime('%H:%M') if s.end_time else 'è¨˜éŒ²ä¸­' }}
                {% else %}
                  N/A
                {% endif %}
              </span>
              {% if s.overall_score is not none %}
                <span class="item-score">{{ s.overall_score }}ç‚¹</span>
              {% endif %}
            </div>
            <div class="item-info">
              {% if s.route_name %}
                ãƒ«ãƒ¼ãƒˆ: {{ s.route_name }}<br>
              {% endif %}
              è·é›¢: {% if s.distance is number %}{{ '%.2f' % s.distance }}{% else %}N/A{% endif %} km
            </div>
            <div class="item-actions">
              <a href="{{ url_for('sessions.detail_result_page', session_id=s.id) }}">è©³ç´°ã‚’è¦‹ã‚‹</a>
              <form action="{{ url_for('views.delete_session', sid=s.id) }}"
                    method="post"
                    style="margin:0"
                    onsubmit="
                      if (!confirm('æœ¬å½“ã«ã“ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                        return false;
                      }
                      const btn = this.querySelector('button');
                      btn.disabled = true;
                      btn.classList.add('btn-deleting');
                      btn.innerHTML = `
                        <span class='spinner-border spinner-border-sm me-2' role='status' aria-hidden='true'></span>
                        å‰Šé™¤ä¸­â€¦
                      `;
                      return true;
                    ">
                <button type="submit" class="btn btn-danger-custom" style="padding:6px 12px;font-size:0.9em">å‰Šé™¤</button>
              </form>
            </div>
          </div>
          {% endfor %}
        {% else %}
          ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
        {% endif %}
      </div>
    </div>

    <nav class="navbar navbar-expand custom-nav-bar fixed-bottom">
    <div class="container-fluid justify-content-center">
        <ul class="navbar-nav w-100 text-center">
        <li class="nav-item flex-fill custom-nav-item">
            <a href="{{ url_for('views.home') }}" class="nav-link custom-nav-link">ãƒ›ãƒ¼ãƒ </a>
        </li>
        <li class="nav-item flex-fill custom-nav-item">
            <a href="{{ url_for('views.recording_start') }}" class="nav-link custom-nav-link">é‹è»¢</a>
        </li>
        <li class="nav-item flex-fill custom-nav-item">
            <a class="nav-link custom-nav-link active" href="{{ url_for('sessions.results_page') }}">ãƒªã‚¶ãƒ«ãƒˆ</a>
        </li>
        <li class="nav-item flex-fill custom-nav-item">
          <a class="nav-link custom-nav-link" href="{{ url_for('views.map_editor') }}">ãƒãƒƒãƒ—</a>
        </li>
        <li class="nav-item flex-fill custom-nav-item border-end-0">
      <a class="nav-link custom-nav-link" href="{{ url_for('views.explain') }}">èª¬æ˜</a>
        </li>
        </ul>
    </div>
    </nav>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
