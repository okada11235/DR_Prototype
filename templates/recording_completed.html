<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ‰ãƒ©ã‚¤ãƒ–ãƒãƒ‡ã‚£ - è¨˜éŒ²å®Œäº†</title>

  <!-- âœ… Bootstrapã‚’è¿½åŠ  -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <style>
    body {
      font-family: "Segoe UI", "Hiragino Kaku Gothic ProN", sans-serif;
      margin: 0;
      padding: 0;
      background-color: #cdeae0;
      color: #333;
      padding-bottom: 55px; /* ãƒŠãƒ“åˆ†ã®ä½™ç™½ */
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-area img {
      width: 50px;
      height: 50px;
    }

    .title {
      font-size: 1.5em;
      font-weight: bold;
      color: #2090c2;
    }

    .main {
      text-align: center;
      padding: 20px;
    }

    .robot {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      background-color: #fff;
      border: 2px solid #2b8ca6;
      margin-bottom: 5px;
    }

    .main-title {
      color: #4db6ac;
      font-size: 1.8em;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .drive-info {
      display: flex;
      justify-content: center;
      gap: 40px;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .section {
      background-color: #fff;
      border-radius: 6px;
      margin: 15px auto;
      padding: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      width: 90%;
      text-align: left;
    }

    .section h2 {
      font-size: 1.3em;
      color: #2090c2;
      margin-bottom: 8px;
      border-bottom: 2px solid #a5dbe0;
      padding-bottom: 4px;
    }

    .score {
      font-size: 1.6em;
      font-weight: bold;
      color: #d32f2f;
      margin-left: 5px;
    }

    .comment {
      font-size: 0.95em;
      color: #444;
      margin-top: 5px;
    }

    .highlight {
      color: #e44d8f;
      font-weight: bold;
    }

    /* === ãƒŠãƒ“ãƒãƒ¼çµ±ä¸€ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆresult.htmlã¨å®Œå…¨ä¸€è‡´ï¼‰ === */
    .custom-nav-bar {
      background: #378da0;
      border-top: 2px solid #5a7d8d;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
      height: 45px;
    }

    /* å„é …ç›® */
    .custom-nav-item {
      flex: 1;
    }

    .custom-nav-bar{background:#378da0;border-top:2px solid #5a7d8d;box-shadow:inset 0 0 5px rgba(0,0,0,.2);height:45px}
    .custom-nav-link{color:#fff;font-weight:bold;font-size:1rem;padding:0 1rem;line-height:41px;height:100%;display:block}
    .custom-nav-item:not(:last-child){border-right:1px solid #5a7d8d}
    .active-glow .custom-nav-link.active{color:rgb(0, 0, 0);background:rgba(255,255,255,.05)}

  </style>
</head>
<body>

  <header>
    <div class="logo-area">
      <img src="{{ url_for('static', filename='img/icon.png') }}" alt="ãƒ‰ãƒ©ã‚¤ãƒ–ãƒãƒ‡ã‚£ãƒ­ã‚´">
      <div class="title">ãƒ‰ãƒ©ã‚¤ãƒ–ãƒãƒ‡ã‚£</div>
    </div>
  </header>

  <main class="main">
    <img src="{{ url_for('static', filename='img/robot.png') }}" alt="ãƒ‰ãƒ©ã‚¤ãƒœ" class="robot">
    <div class="main-title">ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼</div>

    <div class="drive-info">
      <div>èµ°è¡Œæ™‚é–“<br><span id="total-time">--:--</span></div>
      <div>èµ°è¡Œè·é›¢<br><span id="total-distance">-- km</span></div>
    </div>

    <!-- æ¸›é€Ÿ -->
    <div class="section">
      <h2>æ¸›é€Ÿ <span class="score">80ç‚¹</span></h2>
      <p>çµæœï¼šä¸å¯§ã§å®‰å®šï¼</p>
      <p>è©³ç´°ï¼šå¹³å‡å‰æ–¹å‘G = 0.28ã€æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­æ¤œçŸ¥ 1å›</p>
      <p class="comment">ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒ–ãƒ¬ãƒ¼ã‚­ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°å®Œç’§ï¼ä¹—ã‚Šå¿ƒåœ°ãƒãƒƒãƒãƒªğŸ‘</p>
    </div>

    <!-- åŠ é€Ÿ -->
    <div class="section">
      <h2>åŠ é€Ÿ <span class="score">75ç‚¹</span></h2>
      <p>çµæœï¼šå°‘ã—å¼·ã„ã‹ãªï¼Ÿ</p>
      <p>è©³ç´°ï¼šå¹³å‡å¾Œæ–¹å‘G = -0.35ã€æ€¥ç™ºé€²æ¤œçŸ¥ 2å›</p>
      <p class="comment">ã‚³ãƒ¡ãƒ³ãƒˆï¼šå‹¢ã„ã‚ã‚‹ãƒ‰ãƒ©ã‚¤ãƒ–ï¼ã§ã‚‚ã‚‚ã†å°‘ã—æŠ‘ãˆã‚‹ã¨ã‚ˆã‚Šã‚¹ãƒ ãƒ¼ã‚ºğŸ’¨</p>
    </div>

    <!-- æ—‹å› -->
    <div class="section">
      <h2>æ—‹å› <span class="score">70ç‚¹</span></h2>
      <p>çµæœï¼šã‚„ã‚„æ€¥ã‚ï¼Ÿ</p>
      <p>è©³ç´°ï¼šå¹³å‡æ¨ªG = 0.32ã€æ€¥ã‚«ãƒ¼ãƒ–æ¤œçŸ¥ 4å›</p>
      <p class="comment">ã‚³ãƒ¡ãƒ³ãƒˆï¼šå°‘ã—å†…å´ã«åˆ‡ã‚Šè¾¼ã¿æ°—å‘³ï¼æ¬¡ã¯ã‚‚ã†å°‘ã—å¤–ã¸ãµã‚“ã‚ã‚Šå›ã‚ã†ï¼</p>
    </div>

    <!-- ç›´é€² -->
    <div class="section">
      <h2>ç›´é€² <span class="score" style="color:#00796b;">90ç‚¹</span></h2>
      <p>çµæœï¼šå®‰å®šæ„Ÿãƒãƒƒãƒãƒªï¼</p>
      <p>è©³ç´°ï¼šå¹³å‡é€Ÿåº¦ 42km/hã€å‰å¾Œå·¦å³Gã¨ã‚‚ã«å®‰å®š</p>
      <p class="comment">ã‚³ãƒ¡ãƒ³ãƒˆï¼šçœŸã£ã™ãèµ°è¡Œã‚­ãƒ¼ãƒ—ï¼å®‰å®šæ„Ÿã™ã”ã„ğŸ”¥</p>
    </div>

    <!-- ç·è©• -->
    <div class="section">
      <h2>ç·è©• <span class="score" style="color:#4b63d1;">79ç‚¹</span></h2>
      <p>ä»Šå›ã®ç·è©•ã¯79ç‚¹ã§ã—ãŸï¼å…¨ä½“çš„ã«å®‰å®šã—ãŸé‹è»¢ã§ã—ãŸğŸ‘<br>
         ç‰¹ã«ç›´é€²ã®å®‰å®šæ„ŸãŒç´ æ™´ã‚‰ã—ã„ã§ã™ğŸš—ğŸ’¨<br>
         æ—‹å›æ™‚ã®Gå¤‰åŒ–ã‚’ã‚‚ã†å°‘ã—æŠ‘ãˆã‚‰ã‚Œã‚Œã°ã€ã•ã‚‰ã«ä¸Šç´šè€…ãƒ¬ãƒ™ãƒ«ã§ã™ğŸ”¥</p>
    </div>

    <!-- ä»Šå›ã®é‡ç‚¹ãƒã‚¤ãƒ³ãƒˆ -->
    <div class="section">
      <h2 style="color:#e44d8f;">ä»Šå›ã®é‡ç‚¹ãƒã‚¤ãƒ³ãƒˆ</h2>
      <p>ä»Šå›ã®é‡ç‚¹ãƒã‚¤ãƒ³ãƒˆã¯ <b>æ¸›é€Ÿ</b> ã§ã—ãŸãŒã€é‹è»¢é–‹å§‹å‰ã¨æ¯”ã¹ã¦ã¨ã¦ã‚‚è‰¯ããªã£ã¦ãŸã‚ˆï¼ğŸ‘<br>
      ã“ã®èª¿å­ã§æ¬¡ã¯<b>åŠ é€Ÿ</b>ã‚‚æ„è­˜ã—ã¦å…¨ä½“ã®ã‚¹ã‚³ã‚¢ã‚’ä¼¸ã°ãã†ğŸ”¥</p>
    </div>
  </main>

  <!-- âœ… å…±é€šãƒŠãƒ“ãƒãƒ¼ -->
  <nav class="navbar navbar-expand custom-nav-bar fixed-bottom">
    <div class="container-fluid justify-content-center">
      <ul class="navbar-nav w-100 text-center">
        <li class="nav-item flex-fill custom-nav-item">
          <a href="{{ url_for('views.home') }}" class="nav-link custom-nav-link">ãƒ›ãƒ¼ãƒ </a>
        </li>
        <li class="nav-item flex-fill custom-nav-item active-glow">
          <a class="nav-link custom-nav-link active" href="{{ url_for('views.recording_start') }}">é‹è»¢</a>
        </li>

        <!-- âœ… ã“ã“ã« active-glow ã‚’ä»˜ã‘ã‚‹ï¼ˆã“ã®ãƒšãƒ¼ã‚¸ãŒâ€œãƒªã‚¶ãƒ«ãƒˆâ€ãªã‚‰ï¼‰ -->
        <li class="nav-item flex-fill custom-nav-item">
          <a href="{{ url_for('sessions.results_page') }}" class="nav-link custom-nav-link">ãƒªã‚¶ãƒ«ãƒˆ</a>
        </li>

        <li class="nav-item flex-fill custom-nav-item">
          <a class="nav-link custom-nav-link" href="{{ url_for('views.map_editor') }}">ãƒãƒƒãƒ—</a>
        </li>
        <li class="nav-item flex-fill custom-nav-item border-end-0">
          <a class="nav-link custom-nav-link" href="#">èª¬æ˜</a>
        </li>
      </ul>
    </div>
  </nav>

    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCEuouICKd32x3-4y5QzA_2ovq8pydvez4",
            authDomain: "drive-prototype-32ef0.firebaseapp.com",
            projectId: "drive-prototype-32ef0",
            storageBucket: "drive-prototype-32ef0.firebasestorage.app",
            messagingSenderId: "500916744769",
            appId: "1:500916744769:web:d5a529ef05d15bb2934cc0",
            measurementId: "G-9CH5CGYCFM"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function displaySessionResults(sessionData) {
            document.getElementById('total-time').textContent = sessionData.totalTime || '--:--';
            document.getElementById('total-distance').textContent = (sessionData.distance || 0).toFixed(2) + ' km';
            // å®‰å®šåº¦ã®é …ç›®ã‚’å‰Šé™¤
        }

        document.addEventListener('DOMContentLoaded', function() {
            const savedSessionData = localStorage.getItem('lastSessionData');
            if (savedSessionData) {
                try {
                    const sessionData = JSON.parse(savedSessionData);
                    displaySessionResults(sessionData);
                    // å¿…è¦ã«å¿œã˜ã¦ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å†…å®¹ã‚’å‹•çš„ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™
                    // const feedbackElement = document.getElementById('feedback-text');
                    // if(sessionData.sudden_brakes > 5) {
                    //    feedbackElement.textContent = "æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­ãŒéå¸¸ã«å¤šã„ã§ã™ï¼ã‚‚ã£ã¨æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚";
                    // }
                    localStorage.removeItem('lastSessionData');
                } catch (e) {
                    console.error('Failed to parse saved session data:', e);
                }
            }
        });
    </script>
</body>
</html>
