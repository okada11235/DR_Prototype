<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>記録再生（イベント音声）</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="bg-light p-3">
  <div class="container" style="max-width:820px">
    <h1 class="mb-2 text-primary">記録再生モード（イベント音声）</h1>
    <p class="text-muted">開始/終了のUNIXミリ秒（timestamp_ms）を指定して再生します。</p>

    <div class="row g-2">
      <div class="col-md-6">
        <label class="form-label">開始 (ms)</label>
        <input id="replayStart" type="number" class="form-control" placeholder="例: 1760918700000">
      </div>
      <div class="col-md-6">
        <label class="form-label">終了 (ms)</label>
        <input id="replayEnd" type="number" class="form-control" placeholder="例: 1760919000000">
      </div>
    </div>

    <div class="mt-3 d-flex gap-2">
      <!-- 🔽 再生開始ボタンの挙動を変更 -->
      <button id="btnStart" class="btn btn-success btn-lg">再生開始</button>
      <a class="btn btn-outline-dark ms-auto" href="{{ url_for('sessions.detail_result_page', session_id=session_id) }}">戻る</a>
    </div>

    <hr class="my-3"/>

    <div class="p-3 bg-white rounded shadow-sm">
      <p class="text-muted mb-0">再生範囲を指定して「再生開始」を押すと、</p>
      <p class="text-muted">recording_active.html と同じUIで記録が再生されます。</p>
    </div>
  </div>

  <script>
    document.getElementById("btnStart").onclick = () => {
      const startMs = document.getElementById("replayStart").value;
      const endMs = document.getElementById("replayEnd").value;
      if (!startMs || !endMs || parseInt(endMs) <= parseInt(startMs)) {
        alert("開始/終了の時刻(ms)を正しく入力してください");
        return;
      }

      // 🎬 recording_active_re.html に遷移
      const sessionId = "{{ session_id }}";
      const url = `/replay_active/${sessionId}?start=${startMs}&end=${endMs}`;
      window.location.href = url;
    };
  </script>
</body>
</html>
